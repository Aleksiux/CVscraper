{% extends 'base.html' %}
{% block content %}
{% load static %}
<h1> CV page </h1>

<script>
var selectedCity= '{{selected_cities}}';
var cleanedSelectedCity = JSON.parse(selectedCity.replace(/&#x27;/g, '"'));

$(document).ready(function() {
$('#citySelected').multiselect({
buttonClass:'btn btn-warning',
buttonWidth:'260px',
enableFiltering: true,
enableCaseInsensitiveFiltering: true,
includeSelectAllOption: false,
filterPlaceholder:'Search Here..'
});
 $('#citySelected').multiselect('select', cleanedSelectedCity);
});

</script>
<script>
var selectedSpeciality = '{{selected_speciality}}';
var cleanedSelectedSpeciality = JSON.parse(selectedSpeciality.replace(/&#x27;/g, '"'));
$(document).ready(function() {
    $('#jobtitle').multiselect({
        buttonClass:'btn btn-warning',
        buttonWidth:'260px',
        enableFiltering: true,
        enableCaseInsensitiveFiltering: true,
        includeSelectAllOption: false,
        filterPlaceholder:'Search Here..'
    });
     $('#jobtitle').multiselect('select', cleanedSelectedSpeciality);
});

</script>
<div class="card">
    <form method="POST" action="{% url 'cv' %}">
        {% csrf_token %}
        <div class="bs-multiselect">
            <select id="jobtitle" name="selected_job" multiple="multiple">
                <option value="it"> IT
                </option>
                <option value="administration"> Administration
                </option>
                <option value="production"> Production
                </option>
                <option value="medicine"> Medicine</option>
                <option value="transport_driving"> Transport/Driving</option>
            </select>


            <select id="citySelected" name="selected_city" multiple="multiple">
                <option value="Kaune"> Kaunas
                </option>
                <option value="Vilniuje"> Vilnius
                </option>
                <option value="Klaipėdoje"> Klaipeda
                </option>
                <option value="Alytuje"> Alytus</option>
                <option value="Birštone"> Birstonas</option>
                <option value="Jonavoje"> Jonava</option>
                <option value="Darbas namuose"> Darbas namuose</option>
            </select>
            <input name="input_search" type="text" placeholder="Search..">
            <button type="submit" onclick="submitForm()">Submit</button>
        </div>
    </form>
    <p class="p_counter">At the moment there is {{count}} advertisements</p>
    <table class="table table-hover" id="cvTable">
        <tr>
            <th>Logo</th>
            <th>Position</th>
            <th>Employer</th>
            <th>Salary</th>
            <th>Salary taxes</th>
            <th>City</th>
            <th>How old ad</th>
            <th></th>
        </tr>
        {% for data in cvs %}
        <tr>
            {% csrf_token %}
            <td onclick="location.href='{{data.ad_link}}'" style="cursor: pointer"><img src="{{data.logo_url}}"></td>
            <td onclick="location.href='{{data.ad_link}}'" style="cursor: pointer">{{data.position}}</td>
            <td onclick="location.href='{{data.ad_link}}'" style="cursor: pointer">{{data.employer}}</td>
            <td onclick="location.href='{{data.ad_link}}'" style="cursor: pointer">{{data.salary}}</td>
            <td onclick="location.href='{{data.ad_link}}'" style="cursor: pointer">{{data.salary_taxes}}</td>
            <td onclick="location.href='{{data.ad_link}}'" style="cursor: pointer">{{data.city}}</td>
            <td onclick="location.href='{{data.ad_link}}'" style="cursor: pointer">{{data.how_old_ad}}</td>
            <td>
                <div class="heart-like-button {% if data.likes.exists %}liked{% endif %}"
                     data-cv-id="{{data.cv_id}}">
                </div>
            </td>
        </tr>
        {% endfor %}
    </table>

</div>

<script type="text/javascript" src="{% static 'javascript/scripts.js' %}"></script>
{% endblock %}